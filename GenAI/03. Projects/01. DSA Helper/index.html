<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSA Mentor AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&family=Source+Code+Pro&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Rubik', sans-serif;
        }

        :root {
            --primary: #115E59;
            --secondary: #FF6B6B;
            --accent: #FFF7ED;
            --bg-light: #F8FAFC;
            --card-bg: #FFFFFF;
            --text-primary: #1F2937;
            --text-secondary: #6B7280;
            --success: #10B981;
            --danger: #EF4444;
            --code-bg: #E5E7EB;
            --transition: all 0.3s ease;
        }

        body {
            background: linear-gradient(135deg, var(--bg-light), #E5E7EB);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .header {
            background: var(--primary);
            color: var(--accent);
            padding: 10px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            background: var(--secondary);
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .logo-text {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .nav-menu {
            display: flex;
            gap: 15px;
        }

        .nav-item {
            color: var(--accent);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .nav-item:hover {
            color: var(--secondary);
        }

        .menu-toggle {
            display: none;
            color: var(--accent);
            font-size: 1.2rem;
            cursor: pointer;
        }

        /* Main Layout */
        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .left-section {
            flex: 4;
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 300px;
        }

        .right-section {
            flex: 6;
            min-width: 300px;
        }

        /* Input Section */
        .input-section {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        .input-section .card-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .input-section h2 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .input-section i {
            color: var(--secondary);
        }

        .instructions {
            background: var(--accent);
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: flex;
            gap: 8px;
            align-items: flex-start;
        }

        .instructions i {
            color: var(--primary);
            font-size: 1rem;
            margin-top: 3px;
        }

        .instructions p {
            color: var(--text-primary);
            line-height: 1.5;
            font-size: 0.85rem;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        textarea#questionInput {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--text-secondary);
            border-radius: 6px;
            background: var(--accent);
            color: var(--text-primary);
            font-size: 0.9rem;
            min-height: 80px;
            max-height: 150px;
            resize: vertical;
            transition: var(--transition);
            font-family: 'Source Code Pro', monospace;
        }

        textarea#questionInput:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.2);
        }

        textarea#questionInput::placeholder {
            color: var(--text-secondary);
        }

        button#askButton {
            background: var(--secondary);
            color: var(--accent);
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        button#askButton:hover {
            background: var(--primary);
            transform: translateY(-1px);
        }

        button#askButton:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        /* History Panel */
        .history-panel {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            max-height: 200px;
            overflow-y: auto;
        }

        .history-panel h2 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .history-item {
            padding: 8px;
            border-bottom: 1px solid var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .history-item:hover {
            background: var(--accent);
            color: var(--primary);
        }

        /* Output Section */
        .output-section {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            min-height: 300px;
        }

        .output-section .card-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .output-section h2 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .output-container {
            border-radius: 6px;
            background: var(--accent);
            padding: 10px;
            min-height: 250px;
            max-height: 400px;
            overflow-y: auto;
        }

        #outputArea {
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.5;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        #outputArea h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary);
            margin: 10px 0;
        }

        #outputArea p {
            margin-bottom: 10px;
        }

        #outputArea ul,
        #outputArea ol {
            margin: 10px 0 10px 20px;
        }

        #outputArea li {
            margin-bottom: 5px;
        }

        #outputArea code {
            background: var(--code-bg);
            color: var(--primary);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.85rem;
        }

        #outputArea pre code {
            display: block;
            padding: 10px;
            border-radius: 6px;
        }

        #outputArea::-webkit-scrollbar {
            width: 5px;
        }

        #outputArea::-webkit-scrollbar-track {
            background: var(--accent);
            border-radius: 3px;
        }

        #outputArea::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 3px;
        }

        .loading-indicator {
            text-align: center;
            padding: 15px;
            display: none;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 107, 107, 0.2);
            border-top-color: var(--secondary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 8px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            padding: 10px;
            border-radius: 6px;
            margin: 8px 0;
            border-left: 3px solid var(--danger);
            display: flex;
            gap: 6px;
            align-items: center;
            font-size: 0.85rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
                padding: 10px;
            }

            .left-section,
            .right-section {
                flex: 1;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .nav-menu {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 52px;
                left: 0;
                width: 100%;
                background: var(--primary);
                padding: 15px;
            }

            .nav-menu.active {
                display: flex;
            }

            .menu-toggle {
                display: block;
            }

            .logo-text {
                font-size: 1rem;
            }

            .input-section h2,
            .output-section h2,
            .history-panel h2 {
                font-size: 1rem;
            }

            textarea#questionInput,
            #outputArea {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 480px) {
            .logo-text {
                font-size: 0.9rem;
            }

            .input-section h2,
            .output-section h2,
            .history-panel h2 {
                font-size: 0.95rem;
            }

            .instructions p {
                font-size: 0.8rem;
            }

            textarea#questionInput,
            #outputArea {
                font-size: 0.8rem;
            }

            button#askButton {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
        }

        @media (min-width: 1440px) {
            .container {
                padding: 20px;
            }

            .logo-text {
                font-size: 1.3rem;
            }

            .input-section h2,
            .output-section h2,
            .history-panel h2 {
                font-size: 1.2rem;
            }

            .instructions p,
            #outputArea,
            textarea#questionInput {
                font-size: 0.95rem;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-book-open"></i>
            </div>
            <div class="logo-text">DSA Mentor AI</div>
        </div>
        <nav class="nav-menu" id="navMenu">
            <a href="#" class="nav-item active">Home</a>
            <a href="#" class="nav-item">History</a>
            <a href="#" class="nav-item">Tutorials</a>
            <a href="#" class="nav-item">Settings</a>
        </nav>
        <i class="fas fa-bars menu-toggle" id="menuToggle"></i>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="left-section">
            <!-- Input Section -->
            <div class="input-section">
                <div class="card-header">
                    <h2><i class="fas fa-question-circle"></i> Ask a DSA Question</h2>
                </div>
                <div class="instructions">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <p><strong>How to use:</strong> Ask about Data Structures and Algorithms (e.g., arrays, trees, graphs, sorting).</p>
                        <p>Non-DSA questions will be redirected to DSA topics.</p>
                    </div>
                </div>
                <div class="form-group">
                    <label for="questionInput">
                        <i class="fas fa-terminal"></i>
                        Your DSA Question
                    </label>
                    <textarea id="questionInput" placeholder="e.g., How to solve the Two Sum problem?"></textarea>
                </div>
                <button id="askButton">
                    <i class="fas fa-paper-plane"></i>
                    Ask Mentor
                </button>
            </div>

            <!-- History Panel -->
            <div class="history-panel">
                <h2>Question History</h2>
                <div id="historyList"></div>
            </div>
        </div>

        <!-- Output Section -->
        <div class="right-section">
            <div class="output-section">
                <div class="card-header">
                    <h2><i class="fas fa-graduation-cap"></i> Mentor's Response</h2>
                </div>
                <div class="loading-indicator" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>Processing your question...</p>
                </div>
                <div class="output-container">
                    <div id="outputArea">
                        <h3>Welcome to DSA Mentor AI!</h3>
                        <p>I'm here to guide you through Data Structures and Algorithms.</p>
                        <p>Try asking about:</p>
                        <ul>
                            <li>Arrays, Linked Lists, Stacks, Queues</li>
                            <li>Trees, Graphs, and Traversals</li>
                            <li>Sorting, Searching, and Dynamic Programming</li>
                            <li>Problem-solving strategies (e.g., Two Sum)</li>
                        </ul>
                        <p>Example: <code>How to solve the Two Sum problem?</code></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const questionInput = document.getElementById('questionInput');
        const askButton = document.getElementById('askButton');
        const outputArea = document.getElementById('outputArea');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const historyList = document.getElementById('historyList');
        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.getElementById('navMenu');
        let conversationHistory = [];
        let localHistory = [];

        // Replace with your actual Gemini API key
        const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY_HERE'; // Place here your actual API key
        const MODEL_NAME = 'gemini-2.5-flash';
        const SYSTEM_INSTRUCTION = `
            You are a highly experienced DSA (Data Structures and Algorithms) instructor. 
            Your job is to teach and explain concepts related only to DSA such as arrays, linked lists, stacks, queues, trees, graphs, recursion, dynamic programming, etc. 
            Only respond to DSA-related questions. 
            If the user asks anything outside of DSA — such as web development, AI, entertainment, or personal questions — politely respond with:
            "I'm currently focused on teaching DSA. Please ask something related to Data Structures and Algorithms."
            Format responses with:
            - A heading (e.g., "## Topic") for the main topic or question.
            - Ordered lists (e.g., "1. Step") for steps or procedures.
            - Unordered lists (e.g., "- Item") for points or concepts.
            - Paragraphs for explanations.
        `.trim();

        // Toggle mobile menu
        menuToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
        });

        // Handle question submission
        askButton.addEventListener('click', async () => {
            const question = questionInput.value.trim();

            if (!question) {
                outputArea.innerHTML = '<div class="error-message"><i class="fas fa-exclamation-circle"></i> Please enter a DSA question!</div>';
                return;
            }

            if (GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY_HERE') {
                outputArea.innerHTML = '<div class="error-message"><i class="fas fa-exclamation-circle"></i> Please replace GEMINI_API_KEY with your actual API key in the JavaScript code!</div>';
                return;
            }

            outputArea.innerHTML = '';
            loadingIndicator.style.display = 'block';
            askButton.disabled = true;

            try {
                // Add user question to conversation history
                conversationHistory.push({
                    role: 'user',
                    parts: [{ text: question }],
                });

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: conversationHistory,
                        systemInstruction: {
                            parts: [{ text: SYSTEM_INSTRUCTION }],
                        },
                    }),
                });

                if (!response.ok) {
                    let errorMsg = `API Error: ${response.status}`;
                    try {
                        const errorData = await response.json();
                        if (errorData.error && errorData.error.message) {
                            errorMsg = `${errorMsg} - ${errorData.error.message}`;
                            if (errorData.error.status) {
                                errorMsg += ` (Status: ${errorData.error.status})`;
                            }
                            if (errorData.error.message.toLowerCase().includes('api key not valid') || errorData.error.message.toLowerCase().includes('permission denied')) {
                                errorMsg += '<br><strong>Please double-check your API key in the JavaScript code and ensure it’s enabled for the Gemini API.</strong>';
                            }
                        }
                    } catch (parseError) {
                        errorMsg = `${errorMsg} (Could not parse error response: ${response.statusText})`;
                    }
                    throw new Error(errorMsg);
                }

                const data = await response.json();

                if (data.candidates && data.candidates.length > 0 && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
                    let answerText = data.candidates[0].content.parts[0].text;

                    // Add AI response to conversation history
                    conversationHistory.push({
                        role: 'model',
                        parts: [{ text: answerText }],
                    });

                    // Format response for HTML
                    let formattedText = answerText
                        .replace(/^##\s*(.+)$/gm, '<h3>$1</h3>')
                        .replace(/^\d+\.\s*(.+)$/gm, '<ol><li>$1</li></ol>')
                        .replace(/^\-\s*(.+)$/gm, '<ul><li>$1</li></ul>')
                        .replace(/(```[\s\S]*?```)|(`[^`]+`)/g, (match) => {
                            if (match.startsWith('```')) {
                                return `<pre><code>${match.replace(/```/g, '')}</code></pre>`;
                            }
                            return `<code>${match.replace(/`/g, '')}</code>`;
                        })
                        .replace(/\n\n/g, '</p><p>')
                        .replace(/\n/g, '<br>');

                    formattedText = `<p>${formattedText}</p>`
                        .replace(/<p><(h3|ul|ol|pre)>/g, '<$1>')
                        .replace(/<\/(h3|ul|ol|pre)><\/p>/g, '</$1>')
                        .replace(/<\/ol><ol>/g, '')
                        .replace(/<\/ul><ul>/g, '');

                    outputArea.innerHTML = formattedText;

                    // Update local history
                    localHistory.unshift(question);
                    if (localHistory.length > 5) localHistory.pop();
                    updateHistory();
                } else if (data.promptFeedback && data.promptFeedback.blockReason) {
                    outputArea.innerHTML = `<div class="error-message"><i class="fas fa-ban"></i> Blocked due to: ${data.promptFeedback.blockReason}. Details: ${data.promptFeedback.blockReasonMessage || ''}</div>`;
                } else {
                    outputArea.innerHTML = '<div class="error-message"><i class="fas fa-exclamation-triangle"></i> Received an unexpected response from the AI.</div>';
                }

            } catch (error) {
                outputArea.innerHTML = `<div class="error-message"><i class="fas fa-bug"></i> Failed to get answer: ${error.message}</div>`;
            } finally {
                askButton.disabled = false;
                loadingIndicator.style.display = 'none';
            }
        });

        // Update history panel
        function updateHistory() {
            historyList.innerHTML = localHistory.map((item, index) => `
                <div class="history-item" onclick="loadHistoryQuestion(${index})">${item}</div>
            `).join('');
        }

        // Load history question
        window.loadHistoryQuestion = function (index) {
            questionInput.value = localHistory[index];
            askButton.click();
        };

        // Allow Enter key (but not Shift+Enter) to submit
        questionInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                askButton.click();
            }
        });

        // Nav item active state
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
            });
        });
    </script>
</body>

</html>